import unittest
import dask.array as da
import numpy as np

from variation6 import (GT_FIELD, DP_FIELD, MISSING_INT, FLT_VARS, N_KEPT,
                        N_FILTERED_OUT, CHROM_FIELD, POS_FIELD)
from variation6.tests import TEST_DATA_DIR
from variation6.in_out.zarr import load_zarr
from variation6.filters import (remove_low_call_rate_vars,
                                min_depth_gt_to_missing,
                                keep_samples, filter_by_maf_by_allele_count,
                                filter_by_mac, filter_by_maf,
                                keep_variable_variations,
                                keep_variations_in_regions,
                                remove_variations_in_regions, remove_samples,
    filter_by_obs_heterocigosis)

from variation6.compute import compute
from variation6.variations import Variations


class MinCallFilterTest(unittest.TestCase):

    def test_filter_by_call_rate(self):
        variations = load_zarr(TEST_DATA_DIR / 'test.zarr')
        pipeline_futures = {}

        future_result = remove_low_call_rate_vars(variations, min_call_rate=0.5)
        pipeline_futures.update(future_result)

        future_result2 = remove_low_call_rate_vars(future_result[FLT_VARS], min_call_rate=0.5,
                                           filter_id='call_rate2')
        pipeline_futures.update(future_result2)

        processed = compute(pipeline_futures, store_variation_to_memory=True)
        self.assertEqual(processed['call_rate'][N_KEPT], 5)
        self.assertEqual(processed['call_rate'][N_FILTERED_OUT], 2)

        gts = processed[FLT_VARS][GT_FIELD]
        self.assertEqual(gts.shape, (5, 3, 2))
        self.assertTrue(np.all(processed[FLT_VARS].samples == variations.samples.compute()))
        self.assertEqual(processed[FLT_VARS].metadata, variations.metadata)

    def test_filter_by_call_rate_twice(self):
        variations = load_zarr(TEST_DATA_DIR / 'test.zarr')
        pipeline_futures = {}
        # this rate has no sense but I use to remove all calls
        future_result = remove_low_call_rate_vars(variations, min_call_rate=1.1)
        pipeline_futures.update(future_result)

        future_result2 = remove_low_call_rate_vars(future_result[FLT_VARS], min_call_rate=0.5,
                                           filter_id='call_rate2')
        pipeline_futures.update(future_result2)

        processed = compute(pipeline_futures, store_variation_to_memory=True)
        self.assertEqual(processed['call_rate2'], {'n_kept': 0, 'n_filtered_out': 0})


class MinDepthGtToMissing(unittest.TestCase):

    def test_min_depth_gt_to_missing(self):
        variations = load_zarr(TEST_DATA_DIR / 'test.zarr', chunk_size=2)
        variations = remove_low_call_rate_vars(variations, 0)[FLT_VARS]
        depth = 9
        prev_gts = variations[GT_FIELD].compute()
        depths = variations[DP_FIELD].compute()
        task = min_depth_gt_to_missing(variations, min_depth=depth)
        processed = compute(task, store_variation_to_memory=True)
        post_gts = processed[FLT_VARS][GT_FIELD]

        for dp, prev_gt, post_gt in zip(depths, prev_gts, post_gts):
            for dp_, prev_gt_, post_gt_ in zip(dp, prev_gt, post_gt):
                if dp_ != -1 and dp_ < depth:
                    self.assertTrue(np.all(post_gt_ == [MISSING_INT, MISSING_INT]))
                    self.assertFalse(np.all(prev_gt_ == [MISSING_INT, MISSING_INT]))


class FilterSamplesTest(unittest.TestCase):

    def test_keep_samples(self):
        variations = load_zarr(TEST_DATA_DIR / 'test.zarr')
#         print(variations.samples.compute())
#         print(variations[DP_FIELD].compute())

        samples = ['upv196', 'pepo']
        task = keep_samples(variations, samples=samples)
        processed = compute(task, store_variation_to_memory=True)
        dps = processed[FLT_VARS][DP_FIELD]

        self.assertTrue(np.all(processed[FLT_VARS].samples == ['pepo', 'upv196']))
        expected = [[-1, 9], [-1, 8], [-1, 8], [14, 6], [-1, -1], [-1, -1],
                    [-1, 6]]
        self.assertTrue(np.all(dps == expected))

    def test_remove_samples(self):
        variations = load_zarr(TEST_DATA_DIR / 'test.zarr')
        samples = ['upv196', 'pepo']

        task = remove_samples(variations, samples=samples)
        processed = compute(task, store_variation_to_memory=True)
        dps = processed[FLT_VARS][DP_FIELD]
        self.assertTrue(np.all(['mu16'] == processed[FLT_VARS].samples))
        expected = [[10], [9], [9], [-1], [-1], [ 9], [10]]
        self.assertTrue(np.all(dps == expected))


class MafFilterTest(unittest.TestCase):

    def test_maf_by_allele_count_filter(self):
        variations = load_zarr(TEST_DATA_DIR / 'test.zarr')
        task = filter_by_maf_by_allele_count(variations, max_allowable_maf=0.6,
                                             min_num_genotypes=2)
        result = compute(task, store_variation_to_memory=True)
        filtered_vars = result[FLT_VARS]
        self.assertEqual(filtered_vars.num_variations, 4)
        self.assertEqual(result['filter_by_maf_by_allele_count'], {'n_kept': 4,
                                                   'n_filtered_out': 3})

    def test_maf_filter(self):
        variations = load_zarr(TEST_DATA_DIR / 'test.zarr')
        task = filter_by_maf(variations, max_allowable_maf=0.6, max_alleles=3,
                             min_num_genotypes=2)
        result = compute(task, store_variation_to_memory=True)
        filtered_vars = result[FLT_VARS]
        self.assertEqual(filtered_vars.num_variations, 3)
        self.assertEqual(result['filter_by_maf'], {'n_kept': 3,
                                                   'n_filtered_out': 4})

    def test_mac_filter(self):
        variations = load_zarr(TEST_DATA_DIR / 'test.zarr', chunk_size=2)
        task = filter_by_mac(variations, max_allowable_mac=1, max_alleles=3)
        result = compute(task, store_variation_to_memory=True)
        filtered_vars = result[FLT_VARS]
        self.assertEqual(filtered_vars.num_variations, 0)
        self.assertEqual(result['filter_by_mac'], {'n_kept': 0,
                                                   'n_filtered_out': 7})

    def test_filter_macs(self):
        # with some missing values
        gts = np.array([[[0, 0], [1, 1], [0, 1], [1, 1], [0, 0]],
                           [[0, 0], [0, 0], [0, 0], [0, 0], [1, 1]],
                           [[0, 0], [0, 0], [0, 0], [0, 0], [0, 1]],
                           [[0, 0], [-1, -1], [0, 1], [0, 0], [1, 1]]])
        samples = np.array([str(i) for i in range(gts.shape[1])])
        variations = Variations(samples=da.array(samples))
        variations[GT_FIELD] = da.from_array(gts)
        task = filter_by_mac(variations, max_alleles=2, min_num_genotypes=5)
        result = compute(task, store_variation_to_memory=True)
        assert result['filter_by_mac'][N_KEPT] == 4
        assert result['filter_by_mac'][N_FILTERED_OUT] == 0

        task = filter_by_mac(variations, max_alleles=2, min_num_genotypes=5,
                             min_allowable_mac=0)
        result = compute(task, store_variation_to_memory=True)
        assert np.all(result[FLT_VARS][GT_FIELD] == gts[[0, 1, 2]])
        assert result['filter_by_mac'][N_KEPT] == 3
        assert result['filter_by_mac'][N_FILTERED_OUT] == 1

        # without missing values
        gts = np.array([[[0, 0], [1, 1], [0, 1], [1, 1], [0, 0]],
                           [[0, 0], [0, 0], [0, 0], [0, 0], [1, 1]],
                           [[0, 0], [0, 0], [0, 0], [0, 0], [0, 1]],
                           [[0, 0], [0, 0], [0, 1], [0, 0], [1, 1]]])
        samples = np.array([str(i) for i in range(gts.shape[1])])
        variations = Variations(samples=da.array(samples))
        variations[GT_FIELD] = da.from_array(gts)
        task = filter_by_mac(variations, max_alleles=2, min_num_genotypes=0,
                             max_allowable_mac=4)
        result = compute(task, store_variation_to_memory=True)
        expected = np.array([[[0, 0], [1, 1], [0, 1], [1, 1], [0, 0]],
                               [[0, 0], [0, 0], [0, 0], [0, 0], [1, 1]],
                               [[0, 0], [0, 0], [0, 1], [0, 0], [1, 1]]])

        assert np.all(result[FLT_VARS][GT_FIELD] == expected)
        expected = np.array([[[0, 0], [0, 0], [0, 0], [0, 0], [1, 1]],
                               [[0, 0], [0, 0], [0, 1], [0, 0], [1, 1]]])
        task = filter_by_mac(variations, max_alleles=2, min_num_genotypes=0,
                             min_allowable_mac=3.5, max_allowable_mac=4)
        result = compute(task, store_variation_to_memory=True)
        assert np.all(result[FLT_VARS][GT_FIELD] == expected)

        expected = np.array([[[0, 0], [1, 1], [0, 1], [1, 1], [0, 0]]])
        task = filter_by_mac(variations, max_alleles=2, min_num_genotypes=0,
                             max_allowable_mac=3)
        result = compute(task, store_variation_to_memory=True)
        assert np.all(result[FLT_VARS][GT_FIELD] == expected)

        task = filter_by_mac(variations, max_alleles=2, min_num_genotypes=0,
                             min_allowable_mac=2, max_allowable_mac=5)
        result = compute(task, store_variation_to_memory=True)

        assert np.all(result[FLT_VARS][GT_FIELD] == variations[GT_FIELD])


class NoVariableOrMissingTest(unittest.TestCase):

    def test_non_variable_filter(self):
        variations = Variations(samples=da.array(['aa', 'bb']))

        gts = np.array([[[0, 0], [0, 0]],
                        [[0, 2], [1, -1]],
                        [[0, 0], [1, 1]],
                        [[-1, -1], [-1, -1]]
                       ])
        variations[GT_FIELD] = da.from_array(gts)

        task = keep_variable_variations(variations, max_alleles=3)

        result = compute(task, store_variation_to_memory=True)

        filtered_vars = result[FLT_VARS]
        self.assertEqual(filtered_vars.num_variations, 2)
        self.assertEqual(result['variable_variations'], {'n_kept': 2,
                                                                   'n_filtered_out': 2})


class FilterByPositionTest(unittest.TestCase):

    def _create_fake_variations_and_regions(self):
        variations = Variations(samples=da.array(['aa', 'bb']))
        poss = np.array([1, 2, 3, 4, 5, 6, 7, 8, 9, 0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 0])
        chroms = np.array(['chr1', 'chr1', 'chr1', 'chr1', 'chr1', 'chr1', 'chr1', 'chr1', 'chr1', 'chr1',
                           'chr2', 'chr2', 'chr2', 'chr2', 'chr2', 'chr2', 'chr2', 'chr2', 'chr2', 'chr2'])
        variations[CHROM_FIELD] = da.from_array(chroms)
        variations[POS_FIELD] = da.from_array(poss)
        regions = [('chr1', 4, 6), ('chr2',)]
        return variations, regions

    def test_keep_variations_in_regions(self):
        variations, regions = self._create_fake_variations_and_regions()
        task = keep_variations_in_regions(variations, regions)
        result = compute(task, store_variation_to_memory=True)
        chroms = result[FLT_VARS][CHROM_FIELD]
        poss = result[FLT_VARS][POS_FIELD]
        self.assertTrue(np.all(poss == [4, 5, 1, 2, 3, 4, 5, 6, 7, 8, 9, 0]))
        self.assertTrue(np.all(chroms == ['chr1', 'chr1', 'chr2', 'chr2',
                                          'chr2', 'chr2', 'chr2', 'chr2',
                                          'chr2', 'chr2', 'chr2', 'chr2']))

    def test_remove_variations_in_regions(self):
        variations, regions = self._create_fake_variations_and_regions()
        task = remove_variations_in_regions(variations, regions)
        result = compute(task, store_variation_to_memory=True)
        chroms = result[FLT_VARS][CHROM_FIELD]
        poss = result[FLT_VARS][POS_FIELD]
        self.assertTrue(np.all(poss == [1, 2, 3, 6, 7, 8, 9, 0]))
        self.assertTrue(np.all(chroms == ['chr1', 'chr1', 'chr1', 'chr1',
                                          'chr1', 'chr1', 'chr1', 'chr1']))


class ObsHetFiltterTest(unittest.TestCase):

    def test_filter_obs_het(self):
        variations = Variations()
        gts = np.array([[[0, 0], [1, 1], [0, 1], [1, 1], [0, 0]],
                        [[0, 0], [0, 0], [0, 0], [0, 0], [1, 1]],
                        [[0, 0], [0, 0], [0, 0], [0, 0], [0, 1]],
                        [[0, 0], [0, 0], [0, 1], [0, 0], [1, 1]]])
        variations.samples = da.from_array([1, 2, 3, 4, 5])
        variations[GT_FIELD] = da.from_array(gts)
        task = filter_by_obs_heterocigosis(variations, min_num_genotypes=0)
        filtered = compute(task, store_variation_to_memory=True)
        assert np.all(filtered[FLT_VARS][GT_FIELD] == gts)
        assert filtered['obs_het'][N_KEPT] == 4
        assert filtered['obs_het'][N_FILTERED_OUT] == 0

        task = filter_by_obs_heterocigosis(variations, min_allowable_het=0.2,
                                           min_num_genotypes=0)
        filtered = compute(task, store_variation_to_memory=True)
        assert np.all(filtered[FLT_VARS][GT_FIELD] == gts[[0, 2, 3]])
        assert filtered['obs_het'][N_KEPT] == 3
        assert filtered['obs_het'][N_FILTERED_OUT] == 1

        task = filter_by_obs_heterocigosis(variations, min_allowable_het=0.2,
                                           min_num_genotypes=10)
        filtered = compute(task, store_variation_to_memory=True)
        assert filtered['obs_het'][N_KEPT] == 0
        assert filtered['obs_het'][N_FILTERED_OUT] == 4

        task = filter_by_obs_heterocigosis(variations, max_allowable_het=0.1,
                                           min_num_genotypes=0)
        filtered = compute(task, store_variation_to_memory=True)
        assert np.all(filtered[FLT_VARS][GT_FIELD] == gts[[1]])

        task = filter_by_obs_heterocigosis(variations, min_allowable_het=0.2,
                                           max_allowable_het=0.3,
                                           min_num_genotypes=0)
        filtered = compute(task, store_variation_to_memory=True)
        assert np.all(filtered[FLT_VARS][GT_FIELD] == gts[[0, 2, 3]])

    def test_obs_het_filter(self):
#         dps = np.array([[1, -1, 10]])
#         gts = np.array([[[0, 1], [-1, -1], [0, 1]]])
#
#         variations = Variations()
#         variations.samples = da.from_array([1, 2, 3])
#         variations[GT_FIELD] = da.from_array(gts)
#         variations[DP_FIELD] = da.from_array(dps)
#
#         task = filter_by_obs_heterocigosis(variations, min_num_genotypes=0,
#                                            min_call_dp_for_het_call=10,
#                                            max_allowable_het=0.6)
#         filtered = compute(task, store_variation_to_memory=True)
#         print(filtered[FLT_VARS][GT_FIELD])
#         dps = np.array([[10]])
#         print(dps < 10)
#
#         dps_dask = da.from_array(dps)
#         print(da.compute(dps_dask < 10))

#         dps = np.array([[ 1, -1, 20, 3, 3, 4, 3, 1, 8, 3, 5, 1, 2, 6, -1, 4, 4,
#         2, 1, 3, 8, 1, 2, 2, -1, 4, 2, 2, 4, -1, 5, 3, 9, -1,
#         4, 1, 1, 2, 4, 4, 2, 1, 1, 1, -1, 2, 4, 1, 2, 4, -1,
#         3, 3, 7, 4, 3, 3, 5, 1, 5, 1, 3, 3, 5, 2, -1, 1, 1,
#         7, -1, 4, 4, 3, 1, 1, -1, 1, -1, 3, -1, 3, -1, 1, 3, 2,
#         1, 1, -1, 4, 1, 2, -1, -1, 2, 6, 5, -1, 2, -1, 1, 1, 2,
#         2, 10, -1, 3, 1, 2, 1, 2, 1, 5, 2, 2, 3, -1, -1, 3, 7,
#         9, 1, -1, 2, 2, 2, 1, 3, 3, 3, -1, 1, 1, 1, 3, 1, 4,
#         1, 2, 2, 1, -1, 3, 1, 1, 3, 3, 2, 2, -1, 4, -1, 5, 3,
#         1, -1, 2, 3, 1, 3, -1, 1, 4, 1, -1, -1, 1, 5, -1, 3, -1,
#         4, 3, 2, 4, 5, 1, -1, 3, 3, 2, -1, 3, 3, 4, -1, 2, 2,
#         2, 4, 2, 4, 1, 2, 2, 6, 1, 2, -1, 3, -1, -1, 1, 2, 12,
#         1, -1, 4, 7, 2, -1, 2, 1, 1, 1, 2, -1, 4, 5, 1, 2, -1,
#         1, 3, 1, 1, 1, 1, 2, 4, 2, 5, 2, 4, -1, 6, 2, 2, 4,
#         6, 6, 3, -1, 4, 3, 2, 4, 1, 2, 3, 1, 1, 2, 3, 3, -1,
#         4, 2, 1, 2, 4, 39, 2, -1, 2, 5, 5, 2, -1, 3, -1, -1, 4,
#         2, -1, 1, 2, 4, 4, 4, 3, 9, 3, 2, 3, 18, 3, 1, 2, 2,
#        -1, 4]])
#         dps2 = np.array([[ 1, -1, 20, 3, 3, 4, 3, 1, 8, 3, 5, 1, 2, 6, -1, 4, 4,
#         2, 1, 3, 8, 1, 2, 2, -1, 4, 2, 2, 4, -1, 5, 3, 9, -1,
#         4, 1, 1, 2, 4, 4, 2, 1, 1, 1, -1, 2, 4, 1, 2, 4, -1,
#         3, 3, 7, 4, 3, 3, 5, 1, 5, 1, 3, 3, 5, 2, -1, 1, 1,
#         7, -1, 4, 4, 3, 1, 1, -1, 1, -1, 3, -1, 3, -1, 1, 3, 2,
#         1, 1, -1, 4, 1, 2, -1, -1, 2, 6, 5, -1, 2, -1, 1, 1, 2,
#         2, 10, -1, 3, 1, 2, 1, 2, 1, 5, 2, 2, 3, -1, -1, 3, 7,
#         9, 1, -1, 2, 2, 2, 1, 3, 3, 3, -1, 1, 1, 1, 3, 1, 4,
#         1, 2, 2, 1, -1, 3, 1, 1, 3, 3, 2, 2, -1, 4, -1, 5, 3,
#         1, -1, 2, 3, 1, 3, -1, 1, 4, 1, -1, -1, 1, 5, -1, 3, -1,
#         4, 3, 2, 4, 5, 1, -1, 3, 3, 2, -1, 3, 3, 4, -1, 2, 2,
#         2, 4, 2, 4, 1, 2, 2, 6, 1, 2, -1, 3, -1, -1, 1, 2, 12,
#         1, -1, 4, 7, 2, -1, 2, 1, 1, 1, 2, -1, 4, 5, 1, 2, -1,
#         1, 3, 1, 1, 1, 1, 2, 4, 2, 5, 2, 4, -1, 6, 2, 2, 4,
#         6, 6, 3, -1, 4, 3, 2, 4, 1, 2, 3, 1, 1, 2, 3, 3, -1,
#         4, 2, 1, 2, 4, 39, 2, -1, 2, 5, 5, 2, -1, 3, -1, -1, 4,
#         2, -1, 1, 2, 4, 4, 4, 3, 9, 3, 2, 3, 18, 3, 1, 2, 2,
#        -1, 4]])
#
#         print(np.all(dps == dps2))
#         print(np.sum(dps < 10, axis=1))
#         print(da.sum(da.from_array(dps) < 10, axis=1).compute())

        dps = np.array([[-1, 4, 4, 2, 6, 7, 6, 1, 4, 8, 9, 6, 6, 2, -1, -1, -1, 2, 12, 8, 2, 2, 4, 4, -1, -1, -1, 3, 2, 10, 4, -1, 4, 2, -1, 4, -1, -1, -1, 8, -1, 1, 8, -1, 4, 2, 7, -1, -1, 1, 4, 9, 6, -1, 4, 6, 1, 2, 2, 2, -1, 2, -1, -1, 4, 2, 4, 10, 9, 4, 2, 2, 6, 9, 8, 6, -1, -1, 6, -1, 8, 1, 4, 2, 6, 4, 4, -1, 2, -1, 3, 12, 5, 1, 6, 6, -1, -1, 2, -1, 6, 2, 4, 2, 3, 8, -1, 4, 2, -1, 2, 6, 2, -1, 7, 2, 1, 2, 2, 4, 2, -1, -1, -1, -1, -1, 10, 4, 1, 1, -1, 2, 4, 2, 2, 1, 2, 7, 4, -1, 2, 5, 5, 3, 4, 5, 2, 2, 2, 1, -1, 4, 4, -1, 1, -1, -1, 1, -1, 2, -1, 1, 7, -1, -1, 4, 11, -1, 2, 1, -1, 4, 4, 2, 2, 2, 6, 1, 6, 4, 2, 4, 2, 2, 3, 2, 4, 4, -1, 2, -1, 2, 1, 2, 4, 4, -1, 8, 5, 2, -1, 5, 7, 4, 2, -1, 8, 6, 1, 2, 2, 2, 4, 4, 3, 10, 4, 2, -1, 3, 10, 2, 1, 2, 2, 4, -1, 2, 4, 2, -1, 4, 2, -1, 4, 2, -1, 2, 6, 8, -1, 2, 3, 2, 7, 2, -1, -1, -1, 4, -1, -1, 4, -1, -1, -1, -1, 5, 8, 3, 4, 8, 2, 2, -1, -1, -1, 5, 2, 6, 4, -1, -1, -1, 7, -1, 8, 6, 5, 1, -1, -1, 4, 6, 4, 4, 7, 3, 4, 3, 6, -1, 4, 4, 2, 4, 4, 2, 2, 7, 4, 6, 7, 2, 7, 3, 2, 2, 2, 2, 5, 2, 3, 4, 4, 2, 7, 2, 4, 1, 4, 2, 5, 2, -1, 5, 2, 4, 5, -1, -1, 6, 2, 5, 4, 2, 3, 4, 18, -1, -1, -1, -1, 5, 2, -1, -1, 4, 6, 2, 4, 8, 2, 6, -1, -1, 2, 2, -1, 4, -1, 7, 3, 2, 5, 4, 2, 5, 2, 4, -1, -1, -1, 2, -1, -1, 4, -1, 4, 8, 5, 3, 2, 2, 12, 8, 4, 2, 2, 4, -1, 5, -1, -1, -1, 4, -1, -1, 1, -1, 4, 6, 8, 2, -1, 2, 4, 1, 5, 4, 2, 2, 5, -1, -1, 1, 6, -1, -1, 6, 2, -1, -1, -1, -1, 2, 6, 8, 4, 4, -1, 4, 2, 6, 2, 3, 2, 2, 3, -1, -1, 2, 7, 6, 2, -1, 4, 1, 3, -1, -1, 2, 2, 1, 4, 2, 6, 4, 12, 4, 1, 4, -1, -1, 9, 5, -1, -1, 2, 1, 3, 4, -1, 2, 1, 2, 6, 6, 2, 3, 6, -1, 2, 6, -1, 4, 4, 1, -1, -1, 2, 6, 2, 6, -1, -1, 10, 1, 2, -1, 4, 2, 4, 6, 2, 9, 3, 2, -1, 6, 2, -1, 2, 4, 2, 3, -1, -1, 2, -1, 4, -1, 4, -1, 1, 2, -1, 2, 4, 6, -1, 6, 6, 2, -1, 2, 1, -1, 6, 6, 2, -1, 3, 7, 2, 4, 22, 3, 4, 8, 2, 10, 3, 6, 2, -1, -1, 10, 10, 8, 1, 4, 10, 4, 4, -1, 8, 5, 12, 2, 7, 4, 4, 4, 16, 6, 6, -1, 15, -1, 3, 4, 3, -1, -1, 6, 4, 3, 4, 2, 8, 6, 6, 3, -1, 2, -1, 1, 6, 11, -1, 3, 3, 4, 2, -1, -1, 5, 1, 2, 2, 1, 10, -1, 2, 6, -1, 1, 11, 4, 4, 4, 4, -1, 6, 2, 6, 6, 1, 4, 6, 2, 6, -1, -1, -1, 2, 8, 4, -1, 7, 1, -1, 6, 2, 6, 5, 12, 4, -1, 8, 7, 2, 2, 4, 2, 1, 2, 2, 2, -1, 10, 6, -1, 5, 6, 3, -1, -1, -1, 3, 5, 6, 4, -1, -1, 2, -1, -1, 5, 14, 2, -1, 4, 10, -1, -1, -1, 3, 2, 6, -1, -1, 1, 2, 2, 2, -1, 2, -1, 2, 3, 8, 1, 6, 2, 2, -1, 2, 2, 6, 5, 4, -1, 3, 2, -1, 2, 4, 2, 4, -1, 5, 1, -1, 7, 4, 4, 6, -1, -1, -1, 4, 2, 4, 6, 3, 2, 2, 4, 7, 2, 2, 2, 4, 5, -1, 2, 7, 19, -1, 2, 4, 2, 1, -1, 4, -1, 4, 8, 7, -1, 4, -1, -1, 16, 4, 8, -1, 2, 6, -1, -1, -1, 6, 3, 6, 2, 3, 2, 2, 4, 1, 4, 2, 4, 5, 2, -1, -1, 6, -1, 5, 2, 2, 2, 2, 4, 4, 6, 7, 4, -1, -1, 4, 2, 4, 2, 6, 1, -1, 2, 4, 5, -1, 6, -1, 7, 3, 1, 8, 4, 2, -1, -1, 8, -1, -1, -1, -1, -1, 4, 5, 2, 1, -1, 6, 6, 2, -1, 4, 12, 2, -1, 2, 2, -1, 2, 2, 2, 10, 4, 3, 4, 4, 2, -1, 3, -1, 2, 6, -1, 4, 6, 2, 5, 2, 2, 1, 4, 1, -1, 6, 3, -1, 2, 2, 2, -1, 11, 2, 4, 2, -1, 4, -1, 2, 6, -1, 2, 8, 6, 5, 6, 6, -1, -1, -1, 6, -1, 4, 6, 2, 5, -1, 6, 9, 3, 2, 12, 4, 2, 2, 6, 1, -1, 3, -1, 6, 2, 4, 3, -1, -1, -1, 2, -1, -1, 6, 2, -1, 4, 2, -1, 2, -1, 3, 6, 4, 10, -1, 4, -1, -1, 2, 2, 2, 2, 10, -1, 3, 2, 5, 3, 10, -1, 2, -1, -1, -1, 2, 2, 6, 1, 5, -1, -1, 2, -1, 6, -1, 2, 2, -1, 2, -1, -1, 2, 3, -1, 4, 2, 6, 4, 1, -1, 6, 8, 2, 7, 8, 2, 2, 2, 4, 2, 2, 2, 10, -1, -1, 5, -1, 2, 1, 4, 2, 2, 2, -1, 2, 2, 2, 8, -1, 2, 4, -1, 2, -1, 6, -1, 1, -1, 3, 2, 1, 2, 10, 2, -1, 4, 6, 2, 4, 2, 2, 2, 4, -1, 6, -1, -1, 1, -1, 4, 2, 4, 1, -1, 6, 2, -1, 12, 2, -1, 2, -1, 3, -1, 12, 1, 1, 4, 3, 10, 4, -1, 2, -1, 1, 4, 2, 6, -1, 4, 3, 2, -1, 3, 10, 4, 6, -1, 1, -1, 4, 6, 2, 6, 2, -1, 6, 2, -1, 5, -1, 6, 1, -1, 7, 4, -1, 4, 5, 6, -1, 2, 2, 2, -1, 6, 9, 6, -1, 6, 2, -1, 4, 4, 2, 3, -1, 8, 2, 2, 3, -1, 4, 9, -1, 2, 2, -1, 2, 9, -1, 2, 2, 2, -1, 4, 2, -1, 6, 6, 6, 2, -1, 11, 2, 6, 8, -1, -1, 2, 4, -1, 1, 5, 2, 2, 6, 6, 2, 2, 8, -1, 12, 5, 4, 2, -1, -1, 2, 1, 5, -1, 1, 7, 8, 2, 1, -1, -1, -1, 6, 6, 4, -1, 2, -1, 2, 7, 9, 2, -1, -1, -1, 2, 2, 6, 10, 4, 2, 4, 2, -1, -1, 2, -1, 2, 2, 13, 2, 7, -1, -1, 2, 2, 8, 2, -1, -1, 4, -1, 4, 2, 2, 2, 6, -1, -1, 7, 2, 7, 2, 2, 4, 8, 4, 2, 8, 4, 4, -1, 6, -1, 7, 1, 3, 2, 2, 6, -1, 5, 12, 10, 6, -1, 7, 5, 7, -1, -1, 4, 4, 12, 8, -1, 2, 6, -1, -1, 2, 8, 7, 6, 2, -1, 6, 2, 6, 5, 2, -1, 4, 4, -1, 3, 2, 4, 6, 4, 10, 4, -1, 4, 4, 3, 2, -1, 2, 2, 4, -1, 3, -1, 2, 4, 4, 12, -1, -1, 2, 9, 5, 2, 2, 6, -1, 4, -1, 4, 2, 6, 4, 4, 5, 6, 2, -1, 2, 4, -1, 2, 3, 2, -1, 4, 4, 1, 4, -1, -1, -1, -1, -1, 8, -1, 12, 7, 1, -1, 5, -1, 2, 5, 4, -1, 2, 4, 7, -1, 4, 2, -1, -1, -1, 4, 2, 2, 3, -1, 1, 2, 5, -1, -1, 6, 2, -1, -1, -1, 4, 4, 6, 2, 6, 2, 2, 7, 4, -1, 2, 4, 10, -1, 2, 2, 2, -1, 2, 2, -1, -1, -1, 2, -1, 4, 2, 7, 4, 10, 2, -1, 2, 4, 4, 6, -1, -1, 3, 2, 4, 1, -1, -1, -1, 4, 2, -1, -1, 6, -1, 6, 2, -1, -1, 2, -1, 4, 1, 2, 4, 4, 4, 3, 2, 2, 10, 2, 4, 4, 6, 8, 3, 2, 4, 2, 6, -1, 2, 2, 2, -1, 5, 2, 1, 2, 3, -1, 2, -1, 4, 4, -1, 2, 4, 4, 4, 2, 2, 2, 3, -1, 9, 3, 2, 1, 4, -1, 7, 4, 6, 5, 4, -1, 1, -1, 2, 1, 10, -1, 1, -1, 2, 4, 2, -1, 2, 5, 4, 1, 6, -1, 4, 5, 3, 3, -1, 4, 2, 2, 1, 7, -1, -1, -1, 1, 2, 10, 2, 2, -1, -1, 5, 5, 4, 6, 3, 4, 6, 4, -1, 4, -1, 4, 4, -1, 3, 2, 2, 3, -1, 2, 4, 4, 8, -1, 2, -1, 4, 4, 2, 3, -1, 2, 4, 2, 4, 3, 4, -1, 2, 2, -1, 6, 2, 18, 4, 2, 2, 5, 2, 3, 4, 4, 4, 2, 2, 1, 3, 2, 8, 1, 2, 4, -1, 4, -1, -1, 4, -1, 7, 2, 4, 2, 8, -1, -1, 2, 2, 2, -1, 9, 4, 2, 8, -1, 2, -1, 7, 2, -1, 1, 4, 7, 1, -1, 9, 2, 4, 3, 2, 2, 5, -1, 1, 6, 3, 4, 4, 10, 10, 4, 3, 2, -1, -1, 4, 2, 1, 6, 2, -1, -1, 4, 4, -1, 5, 2, 4, 12, 2, 2, 3, 6, 2, -1, 8, 2, 5, -1, 3, 2, 4, 2, 4, 6, 6, -1, 7, 10, 2, 4, 7, -1, 4, -1, 2, 6, 2, -1, -1, 2, -1, 8, 2, -1, -1, 8, -1, 2, 5, 4, 2, 6, -1, 1, 3, 3, 10, 7, 2, -1, -1, 2, 6, 5, 10, -1, -1, 2, 1, -1, 2, 2, 6, -1, -1, -1, 6, 3, 5, 3, -1, -1, 6, 6, -1, 2, 4, 5, -1, 5, -1, 12, 2, -1, 3, 5, 2, 2, 4, 1, 4, 2, 10, 4, 2, 8, -1, -1, 2, 2, 4, -1, -1, 2, -1, 2, -1, 2, 6, 3, 4, 7, 2, 4, 2, 7, 2, 5, 6, 1, -1, 2, 3, 4, 9, 2, 2, 2, 2, 2, 6, 2, 1, 4, 2, 4, 2, 2, 9, 4, -1, 6, 2, 2, 2, 6, 6, -1, -1, 2, 3, 6, 2, -1, 2, 5, -1, 6, 2, 2, 2, -1, 9, 4, 4, 2, 2, 4, 2, 2, 4, 8, 4, 2, 4, -1, 2, 10, -1, 3, 2, -1, 4, 2, 4, 2, 1, 3, 2, 8, 6, -1, 8, 4, 7, -1, 4, 4, 2, 8, 3, -1, 8, 7, 4, 4, 8, -1, -1, -1, 2, 2, -1, -1, -1, -1, 5, 2, 4, 6, 2, 4, -1, 6, 5, 1, 4, 8, -1, 2, -1, 4, 2, 4, 2, 4, 2, -1, 2, 10, 3, 1, -1, 2, 2, 9, 6, 2, 8, 2, -1, 2, 4, -1, -1, -1, -1, 3, -1, 1, 4, -1, -1, 2, -1, -1, 4, 2, 4, 3, -1, 2, -1, 4, -1, 2, 4, 6, 2, 3, -1, 8, 1, 1, -1, 4, 8, -1, 2, 2, 7, 10, -1, 6, -1, 4, 8, 5, 6, 4, 7, 2, -1, 1, -1, -1, 3, 4, -1, 2, 2, 2, 4, -1, 2, 2, 2, 2, 2, 4, 4, 2, 4, 7, 8, -1, 8, 2, 2, 12, 1, 4, -1, -1, -1, 7, 8, 2, -1, 4, 2, 2, -1, -1, 4, -1, 2, 4, 2, -1, -1, 4, 5, 9]])
        gts = np.array([[[-1, -1], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [1, 1], [0, 0], [0, 0], [-1, -1], [-1, -1], [-1, -1], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [-1, -1], [-1, -1], [-1, -1], [0, 0], [0, 0], [0, 0], [0, 0], [-1, -1], [0, 0], [0, 0], [-1, -1], [0, 0], [-1, -1], [-1, -1], [-1, -1], [0, 0], [-1, -1], [1, 1], [0, 0], [-1, -1], [0, 0], [0, 0], [0, 0], [-1, -1], [-1, -1], [0, 0], [0, 0], [0, 0], [0, 0], [-1, -1], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [-1, -1], [0, 0], [-1, -1], [-1, -1], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [-1, -1], [-1, -1], [0, 0], [-1, -1], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [-1, -1], [0, 0], [-1, -1], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [-1, -1], [-1, -1], [0, 0], [-1, -1], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [-1, -1], [0, 0], [0, 0], [-1, -1], [0, 0], [0, 0], [0, 0], [-1, -1], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [-1, -1], [-1, -1], [-1, -1], [-1, -1], [-1, -1], [0, 0], [0, 0], [0, 0], [0, 0], [-1, -1], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [-1, -1], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [-1, -1], [0, 0], [0, 0], [-1, -1], [0, 0], [-1, -1], [-1, -1], [0, 0], [-1, -1], [0, 0], [-1, -1], [0, 0], [0, 0], [-1, -1], [-1, -1], [0, 0], [0, 0], [-1, -1], [0, 0], [0, 0], [-1, -1], [0, 0], [0, 0], [0, 0], [0, 1], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [-1, -1], [0, 0], [-1, -1], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [-1, -1], [0, 0], [0, 0], [0, 0], [-1, -1], [0, 0], [0, 0], [0, 0], [0, 0], [-1, -1], [0, 0], [1, 1], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [-1, -1], [0, 0], [0, 0], [0, 0], [1, 1], [1, 1], [0, 0], [0, 0], [-1, -1], [0, 0], [0, 0], [0, 0], [-1, -1], [0, 0], [0, 0], [-1, -1], [0, 0], [0, 0], [-1, -1], [0, 0], [0, 0], [0, 0], [-1, -1], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [-1, -1], [-1, -1], [-1, -1], [0, 0], [-1, -1], [-1, -1], [0, 0], [-1, -1], [-1, -1], [-1, -1], [-1, -1], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [-1, -1], [-1, -1], [-1, -1], [0, 0], [0, 0], [0, 0], [0, 0], [-1, -1], [-1, -1], [-1, -1], [0, 0], [-1, -1], [0, 0], [0, 0], [0, 0], [0, 0], [-1, -1], [-1, -1], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [-1, -1], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [-1, -1], [0, 0], [0, 0], [0, 1], [0, 0], [-1, -1], [-1, -1], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [-1, -1], [-1, -1], [-1, -1], [-1, -1], [0, 0], [0, 0], [-1, -1], [-1, -1], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [-1, -1], [-1, -1], [0, 0], [0, 0], [-1, -1], [0, 0], [-1, -1], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [-1, -1], [-1, -1], [-1, -1], [0, 0], [-1, -1], [-1, -1], [0, 0], [-1, -1], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [-1, -1], [0, 0], [-1, -1], [-1, -1], [-1, -1], [0, 0], [-1, -1], [-1, -1], [0, 0], [-1, -1], [0, 0], [0, 0], [0, 0], [0, 0], [-1, -1], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [-1, -1], [-1, -1], [0, 0], [0, 0], [-1, -1], [-1, -1], [0, 0], [0, 0], [-1, -1], [-1, -1], [-1, -1], [-1, -1], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [-1, -1], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [-1, -1], [-1, -1], [0, 0], [0, 0], [0, 0], [0, 0], [-1, -1], [0, 0], [0, 0], [0, 0], [-1, -1], [-1, -1], [0, 0], [0, 0], [1, 1], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [-1, -1], [-1, -1], [0, 0], [0, 0], [-1, -1], [-1, -1], [0, 0], [0, 0], [0, 0], [0, 0], [-1, -1], [0, 0], [0, 0], [0, 0], [0, 0], [1, 1], [0, 0], [0, 0], [0, 0], [-1, -1], [0, 0], [0, 0], [-1, -1], [0, 0], [0, 0], [0, 0], [-1, -1], [-1, -1], [0, 0], [0, 0], [0, 0], [0, 0], [-1, -1], [-1, -1], [0, 0], [0, 0], [0, 0], [-1, -1], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [-1, -1], [0, 0], [0, 0], [-1, -1], [0, 0], [0, 0], [0, 0], [0, 0], [-1, -1], [-1, -1], [0, 0], [-1, -1], [0, 0], [-1, -1], [0, 0], [-1, -1], [0, 0], [0, 0], [-1, -1], [0, 0], [0, 0], [0, 0], [-1, -1], [0, 0], [0, 0], [0, 0], [-1, -1], [0, 0], [0, 0], [-1, -1], [0, 0], [0, 0], [0, 0], [-1, -1], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [-1, -1], [-1, -1], [0, 0], [0, 0], [0, 0], [1, 1], [0, 0], [0, 0], [0, 0], [0, 0], [-1, -1], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [-1, -1], [0, 0], [-1, -1], [0, 0], [0, 0], [0, 0], [-1, -1], [-1, -1], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [-1, -1], [0, 0], [-1, -1], [0, 0], [1, 1], [0, 0], [-1, -1], [0, 0], [0, 0], [0, 0], [0, 0], [-1, -1], [-1, -1], [0, 0], [0, 0], [1, 1], [0, 0], [0, 0], [0, 0], [-1, -1], [0, 0], [0, 0], [-1, -1], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [-1, -1], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [-1, -1], [-1, -1], [-1, -1], [0, 0], [0, 0], [0, 1], [-1, -1], [0, 0], [0, 0], [-1, -1], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [-1, -1], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [-1, -1], [0, 0], [0, 0], [-1, -1], [0, 0], [0, 0], [0, 0], [-1, -1], [-1, -1], [-1, -1], [0, 0], [0, 0], [0, 0], [0, 0], [-1, -1], [-1, -1], [0, 0], [-1, -1], [-1, -1], [0, 0], [0, 0], [0, 0], [-1, -1], [0, 0], [0, 0], [-1, -1], [-1, -1], [-1, -1], [0, 0], [0, 0], [0, 0], [-1, -1], [-1, -1], [0, 0], [0, 0], [0, 0], [0, 0], [-1, -1], [0, 0], [-1, -1], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [-1, -1], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [-1, -1], [0, 0], [0, 0], [-1, -1], [0, 0], [0, 0], [0, 0], [0, 0], [-1, -1], [0, 0], [0, 0], [-1, -1], [0, 0], [0, 0], [0, 0], [0, 0], [-1, -1], [-1, -1], [-1, -1], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [-1, -1], [0, 0], [0, 0], [0, 0], [-1, -1], [0, 0], [0, 0], [0, 0], [0, 0], [-1, -1], [0, 0], [-1, -1], [0, 0], [0, 0], [0, 0], [-1, -1], [0, 0], [-1, -1], [-1, -1], [0, 0], [0, 0], [0, 0], [-1, -1], [0, 0], [0, 0], [-1, -1], [-1, -1], [-1, -1], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [-1, -1], [-1, -1], [0, 0], [-1, -1], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [-1, -1], [-1, -1], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [-1, -1], [0, 0], [0, 0], [0, 0], [-1, -1], [0, 0], [-1, -1], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [-1, -1], [-1, -1], [0, 0], [-1, -1], [-1, -1], [-1, -1], [-1, -1], [-1, -1], [0, 0], [0, 0], [0, 0], [0, 0], [-1, -1], [0, 0], [0, 0], [0, 0], [-1, -1], [0, 0], [0, 0], [0, 0], [-1, -1], [0, 0], [1, 1], [-1, -1], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [-1, -1], [0, 0], [-1, -1], [0, 0], [0, 0], [-1, -1], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [-1, -1], [0, 0], [0, 0], [-1, -1], [0, 0], [0, 0], [0, 0], [-1, -1], [0, 0], [0, 0], [0, 0], [0, 0], [-1, -1], [0, 0], [-1, -1], [1, 1], [0, 0], [-1, -1], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [-1, -1], [-1, -1], [-1, -1], [0, 0], [-1, -1], [0, 0], [0, 0], [0, 0], [0, 0], [-1, -1], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [1, 1], [-1, -1], [0, 0], [-1, -1], [0, 0], [0, 0], [0, 0], [0, 0], [-1, -1], [-1, -1], [-1, -1], [0, 0], [-1, -1], [-1, -1], [0, 0], [0, 0], [-1, -1], [0, 0], [0, 0], [-1, -1], [0, 0], [-1, -1], [0, 0], [0, 0], [0, 0], [0, 0], [-1, -1], [0, 0], [-1, -1], [-1, -1], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [-1, -1], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [-1, -1], [0, 0], [-1, -1], [-1, -1], [-1, -1], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [-1, -1], [-1, -1], [0, 0], [-1, -1], [0, 0], [-1, -1], [0, 0], [0, 0], [-1, -1], [0, 0], [-1, -1], [-1, -1], [0, 0], [0, 0], [-1, -1], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [-1, -1], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [-1, -1], [-1, -1], [0, 0], [-1, -1], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [-1, -1], [0, 0], [0, 0], [0, 0], [0, 0], [-1, -1], [0, 0], [0, 0], [-1, -1], [0, 0], [-1, -1], [0, 0], [-1, -1], [0, 0], [-1, -1], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [-1, -1], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [-1, -1], [0, 0], [-1, -1], [-1, -1], [0, 0], [-1, -1], [0, 0], [0, 0], [0, 0], [0, 0], [-1, -1], [0, 0], [0, 0], [-1, -1], [0, 0], [1, 1], [-1, -1], [0, 0], [-1, -1], [0, 0], [-1, -1], [0, 0], [1, 1], [0, 0], [0, 0], [0, 0], [0, 0], [0, 1], [-1, -1], [0, 0], [-1, -1], [0, 0], [0, 0], [0, 0], [0, 0], [-1, -1], [0, 0], [0, 0], [0, 0], [-1, -1], [0, 0], [0, 0], [0, 0], [0, 0], [-1, -1], [0, 0], [-1, -1], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [-1, -1], [0, 0], [0, 0], [-1, -1], [0, 0], [-1, -1], [0, 0], [0, 0], [-1, -1], [0, 0], [0, 0], [-1, -1], [0, 0], [0, 0], [0, 0], [-1, -1], [0, 0], [0, 0], [0, 0], [-1, -1], [0, 0], [0, 0], [0, 0], [-1, -1], [0, 0], [0, 0], [-1, -1], [0, 0], [0, 0], [0, 0], [0, 0], [-1, -1], [0, 0], [0, 0], [1, 1], [0, 0], [-1, -1], [0, 0], [0, 0], [-1, -1], [0, 0], [0, 0], [-1, -1], [0, 0], [0, 0], [-1, -1], [0, 0], [0, 0], [0, 0], [-1, -1], [0, 0], [0, 0], [-1, -1], [0, 0], [0, 0], [0, 0], [0, 0], [-1, -1], [0, 1], [0, 0], [0, 0], [0, 0], [-1, -1], [-1, -1], [0, 0], [0, 0], [-1, -1], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [-1, -1], [0, 0], [0, 0], [0, 0], [0, 0], [-1, -1], [-1, -1], [0, 0], [0, 0], [0, 0], [-1, -1], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [-1, -1], [-1, -1], [-1, -1], [0, 0], [0, 0], [0, 0], [-1, -1], [0, 0], [-1, -1], [0, 0], [0, 0], [0, 0], [0, 0], [-1, -1], [-1, -1], [-1, -1], [1, 1], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [-1, -1], [-1, -1], [0, 0], [-1, -1], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [-1, -1], [-1, -1], [0, 0], [0, 0], [0, 0], [0, 0], [-1, -1], [-1, -1], [0, 0], [-1, -1], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [-1, -1], [-1, -1], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [-1, -1], [0, 0], [-1, -1], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [-1, -1], [0, 0], [0, 0], [0, 0], [0, 0], [-1, -1], [0, 0], [0, 0], [0, 0], [-1, -1], [-1, -1], [0, 0], [0, 0], [0, 0], [0, 0], [-1, -1], [0, 0], [0, 0], [-1, -1], [-1, -1], [0, 1], [0, 0], [0, 0], [0, 0], [0, 0], [-1, -1], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [-1, -1], [0, 0], [0, 0], [-1, -1], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [-1, -1], [0, 0], [0, 0], [0, 0], [0, 0], [-1, -1], [0, 0], [0, 0], [0, 0], [-1, -1], [0, 0], [-1, -1], [0, 0], [0, 0], [0, 0], [0, 0], [-1, -1], [-1, -1], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [-1, -1], [0, 0], [-1, -1], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [-1, -1], [0, 0], [0, 0], [-1, -1], [0, 0], [0, 0], [0, 0], [-1, -1], [0, 0], [0, 0], [0, 0], [0, 0], [-1, -1], [-1, -1], [-1, -1], [-1, -1], [-1, -1], [0, 0], [-1, -1], [0, 0], [0, 0], [0, 0], [-1, -1], [0, 0], [-1, -1], [0, 0], [0, 0], [0, 0], [-1, -1], [0, 0], [0, 0], [0, 0], [-1, -1], [0, 0], [0, 0], [-1, -1], [-1, -1], [-1, -1], [0, 0], [0, 0], [0, 0], [0, 0], [-1, -1], [0, 0], [0, 0], [0, 0], [-1, -1], [-1, -1], [0, 0], [0, 0], [-1, -1], [-1, -1], [-1, -1], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [-1, -1], [0, 0], [0, 0], [0, 0], [-1, -1], [0, 0], [0, 0], [0, 0], [-1, -1], [0, 0], [0, 0], [-1, -1], [-1, -1], [-1, -1], [0, 0], [-1, -1], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [-1, -1], [0, 0], [0, 0], [0, 0], [0, 0], [-1, -1], [-1, -1], [0, 0], [0, 0], [0, 0], [0, 0], [-1, -1], [-1, -1], [-1, -1], [0, 0], [0, 0], [-1, -1], [-1, -1], [0, 0], [-1, -1], [0, 0], [0, 0], [-1, -1], [-1, -1], [0, 0], [-1, -1], [0, 0], [1, 1], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [-1, -1], [0, 0], [0, 0], [0, 0], [-1, -1], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [-1, -1], [0, 0], [-1, -1], [0, 0], [0, 0], [-1, -1], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [-1, -1], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [-1, -1], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [-1, -1], [0, 0], [-1, -1], [0, 0], [0, 0], [0, 0], [-1, -1], [0, 0], [-1, -1], [0, 0], [0, 0], [0, 0], [-1, -1], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [-1, -1], [0, 0], [0, 0], [0, 0], [0, 0], [-1, -1], [0, 0], [0, 0], [1, 1], [0, 0], [0, 0], [-1, -1], [-1, -1], [-1, -1], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [-1, -1], [-1, -1], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [-1, -1], [0, 0], [-1, -1], [0, 0], [0, 0], [-1, -1], [0, 0], [0, 0], [0, 0], [0, 0], [-1, -1], [0, 0], [0, 0], [0, 0], [0, 0], [-1, -1], [0, 0], [-1, -1], [0, 0], [0, 0], [0, 0], [0, 0], [-1, -1], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [-1, -1], [0, 0], [0, 0], [-1, -1], [0, 0], [0, 0], [0, 0], [1, 1], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [-1, -1], [0, 0], [-1, -1], [-1, -1], [0, 0], [-1, -1], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [-1, -1], [-1, -1], [0, 0], [0, 0], [0, 0], [-1, -1], [0, 0], [0, 0], [1, 1], [0, 0], [-1, -1], [0, 0], [-1, -1], [0, 0], [0, 0], [-1, -1], [0, 0], [0, 0], [0, 0], [0, 0], [-1, -1], [0, 0], [0, 0], [0, 0], [0, 0], [1, 1], [0, 0], [0, 0], [-1, -1], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [-1, -1], [-1, -1], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [-1, -1], [-1, -1], [0, 0], [0, 0], [-1, -1], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [-1, -1], [0, 0], [0, 0], [0, 0], [-1, -1], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [-1, -1], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [-1, -1], [0, 0], [-1, -1], [0, 0], [0, 0], [0, 0], [-1, -1], [-1, -1], [0, 0], [-1, -1], [0, 0], [0, 0], [-1, -1], [-1, -1], [0, 0], [-1, -1], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [-1, -1], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [-1, -1], [-1, -1], [0, 0], [0, 0], [0, 0], [0, 0], [-1, -1], [-1, -1], [0, 0], [0, 0], [-1, -1], [0, 0], [0, 0], [0, 0], [-1, -1], [-1, -1], [-1, -1], [0, 0], [0, 0], [0, 0], [0, 0], [-1, -1], [-1, -1], [0, 0], [0, 0], [-1, -1], [0, 0], [0, 0], [0, 0], [-1, -1], [0, 0], [-1, -1], [0, 0], [0, 0], [-1, -1], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [-1, -1], [-1, -1], [0, 0], [0, 0], [0, 0], [-1, -1], [-1, -1], [0, 0], [-1, -1], [0, 0], [-1, -1], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [1, 1], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [-1, -1], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [-1, -1], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [-1, -1], [-1, -1], [0, 0], [0, 0], [0, 0], [0, 0], [-1, -1], [0, 0], [0, 0], [-1, -1], [0, 0], [0, 0], [0, 0], [0, 0], [-1, -1], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [-1, -1], [0, 0], [0, 0], [-1, -1], [0, 0], [0, 0], [-1, -1], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [-1, -1], [0, 0], [0, 0], [0, 0], [-1, -1], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [-1, -1], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [-1, -1], [-1, -1], [-1, -1], [0, 0], [0, 0], [-1, -1], [-1, -1], [-1, -1], [-1, -1], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [-1, -1], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [-1, -1], [0, 0], [-1, -1], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [-1, -1], [0, 0], [0, 0], [0, 0], [0, 0], [-1, -1], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [-1, -1], [0, 0], [0, 0], [-1, -1], [-1, -1], [-1, -1], [-1, -1], [0, 0], [-1, -1], [0, 0], [0, 0], [-1, -1], [-1, -1], [0, 0], [-1, -1], [-1, -1], [0, 0], [0, 0], [0, 0], [0, 0], [-1, -1], [0, 0], [-1, -1], [0, 0], [-1, -1], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [-1, -1], [0, 0], [0, 0], [0, 0], [-1, -1], [0, 0], [0, 0], [-1, -1], [0, 0], [0, 0], [0, 0], [0, 0], [-1, -1], [0, 0], [-1, -1], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [-1, -1], [0, 0], [-1, -1], [-1, -1], [0, 0], [0, 0], [-1, -1], [0, 0], [0, 0], [0, 0], [0, 0], [-1, -1], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [-1, -1], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [-1, -1], [-1, -1], [-1, -1], [0, 0], [0, 0], [0, 0], [-1, -1], [0, 0], [0, 0], [0, 0], [-1, -1], [-1, -1], [0, 0], [-1, -1], [0, 0], [0, 0], [0, 0], [-1, -1], [-1, -1], [0, 0], [0, 0], [0, 0]]])

        samples = np.array([str(i) for i in range(gts.shape[1])])
        variations = Variations(samples=da.array(samples))
        variations[GT_FIELD] = da.from_array(gts)
        variations[DP_FIELD] = da.from_array(dps)
        task = filter_by_obs_heterocigosis(variations, max_allowable_het=0.1,
                                           min_call_dp_for_het_call=20)
        result = compute(task, store_variation_to_memory=True)[FLT_VARS]
        assert not result.num_variations


if __name__ == '__main__':
    import sys; sys.argv = ['.', 'ObsHetFiltterTest.test_obs_het_filter']
    unittest.main()
